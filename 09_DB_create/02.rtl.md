# ๐ ุฌููฺฏุฑ ุงุฒ SQL Injection ุฏุฑ PHP (ุฑูุด ุฑููโุง)

ูุง ุฏุฑ ุฌูุณู ูุจู ุงู ฺฉุฏ ุฑุง ุฏุงุดุชู:

```php
$sql = "INSERT INTO students (name, family, nomre_php)
        VALUES ('$name', '$family', '$nomre_php')";
```

โ ุงู ุฑูุด ุฎุทุฑูุงฺฉ ุงุณุช
ฺูู ุงฺฏุฑ ฺฉุงุฑุจุฑ ุฏุงุฎู ูุฑู ุจููุณุฏ:

```sql
' OR 1=1 --
```

ููฺฉู ุงุณุช ฺฉู ุฏุชุงุจุณ ุขุณุจ ุจุจูุฏ!

---

# ๐ฏ ูุฏู ุงู ุฌูุณู

ุงุฏ ุจฺฏุฑู ฺฺฏููู ุจู ุฑูุด **ุงุณุชุงูุฏุงุฑุฏ ู ุงูู (Procedural)** ุฌูู SQL Injection ุฑุง ุจฺฏุฑู.

ูุง ุฏู ุฑูุด ููู ุฏุงุฑู:

1๏ธโฃ ุงุณุชูุงุฏู ุงุฒ `mysqli_real_escape_string()`
2๏ธโฃ ุงุณุชูุงุฏู ุงุฒ **Prepared Statements (ุฑูุด ุงุณุชุงูุฏุงุฑุฏ ุงุตู)** โญโญโญ

---

# ุฑูุด ุงูู: mysqli_real_escape_string()

## โณ ุงุฏู ฺฉุงุฑ ฺุณุชุ

ฺฉุงุฑุงฺฉุชุฑูุง ุฎุทุฑูุงฺฉ ูุซู:

* '
* "
* \

---

ุฑุง ุชุจุฏู ุจู ุญุงูุช ุงูู ูโฺฉูุฏ.

---

## ๐น ฺฉุฏ ุงูู ุดุฏู ุจุง ุงู ุฑูุด:

```php
<?php

$connection = mysqli_connect("localhost", "root", "", "school_db");

if (!$connection) {
    die("ุฎุทุง ุฏุฑ ุงุชุตุงู: " . mysqli_connect_error());
}

// ฺฏุฑูุชู ุงุทูุงุนุงุช
$name = $_POST['name'];
$family = $_POST['family'];
$nomre_php = $_POST['nomre_php'];

// ุงูู ุณุงุฒ ูุฑูุฏ ูุง
$name = mysqli_real_escape_string($connection, $name);
$family = mysqli_real_escape_string($connection, $family);
$nomre_php = mysqli_real_escape_string($connection, $nomre_php);

// ุฏุณุชูุฑ SQL
$sql = "INSERT INTO students (name, family, nomre_php)
        VALUES ('$name', '$family', '$nomre_php')";

$result = mysqli_query($connection, $sql);

if ($result) {
    echo "ุซุจุช ุจุง ููููุช ุงูุฌุงู ุดุฏ.";
} else {
    echo "ุฎุทุง: " . mysqli_error($connection);
}

mysqli_close($connection);

?>
```

---

## โ ุชูุถุญ ุชุงุจุน

```php
mysqli_real_escape_string($connection, $string);
```

### ูพุงุฑุงูุชุฑูุง:

1. ุงุชุตุงู ุฏุชุงุจุณ
2. ุฑุดุชูโุง ฺฉู ูโุฎูุงูู ุงูู ุดูุฏ

---

## โ ูฺฉุชู ููู ุขููุฒุด

ุงู ุฑูุด ุจูุชุฑ ุงุฒ ูุจู ุงุณุช
ุงูุง ูููุฒ ุจูุชุฑู ุฑูุด ูุณุช โ

ฺูู ููุท Escape ูโฺฉูุฏ
ูู ุฑูุด ุงุณุชุงูุฏุงุฑุฏ ุฌูุงู ุงุณุชูุงุฏู ุงุฒ **Prepared Statement** ุงุณุช.

---

# โญโญโญ ุฑูุด ุฏูู: Prepared Statements (ุฑูุด ุงุณุชุงูุฏุงุฑุฏ ู ุญุฑููโุง)

ุงู ุฑูุด ฺฉุงููุงู ุงูู ุงุณุช ู ุฏุฑ ูพุฑูฺูโูุง ูุงูุน ุจุงุฏ ุงุฒ ุขู ุงุณุชูุงุฏู ุดูุฏ.

---

# ๐ง ุงุฏู Prepared Statement ฺุณุชุ

ุจู ุฌุง ุงูฺฉู ููุฏุงุฑ ุฑุง ูุณุชูู ุฏุงุฎู SQL ุจฺฏุฐุงุฑู:

โ ุงุดุชุจุงู:

```sql
VALUES ('$name')
```

โ ุฏุฑุณุช:

```sql
VALUES (?)
```

ุณูพุณ ููุฏุงุฑ ุฑุง ุฌุฏุงฺฏุงูู ุจู ฺฉูุฆุฑ ูุตู ูโฺฉูู.

ุฏุฑ ุงู ุฑูุด:

* SQL ู ุฏุงุฏู ุงุฒ ูู ุฌุฏุง ูุณุชูุฏ
* ุฏุชุงุจุณ ุฏฺฏุฑ ููโุชูุงูุฏ ุฏุงุฏู ุฑุง ุจู ุนููุงู ุฏุณุชูุฑ ุงุฌุฑุง ฺฉูุฏ

---

# โ ฺฉุฏ ฺฉุงูู ุจู ุฑูุด ุฑููโุง (Procedural)

```php
<?php

$connection = mysqli_connect("localhost", "root", "", "school_db");

if (!$connection) {
    die("ุฎุทุง ุฏุฑ ุงุชุตุงู: " . mysqli_connect_error());
}

// ุฏุฑุงูุช ุงุทูุงุนุงุช ูุฑู
$name = $_POST['name'];
$family = $_POST['family'];
$nomre_php = $_POST['nomre_php'];


// 1๏ธโฃ ุขูุงุฏู ุณุงุฒ ฺฉูุฆุฑ
$sql = "INSERT INTO students (name, family, nomre_php)
        VALUES (?, ?, ?)";

$stmt = mysqli_prepare($connection, $sql);


// 2๏ธโฃ ุงุชุตุงู ูุชุบุฑูุง ุจู ฺฉูุฆุฑ
mysqli_stmt_bind_param($stmt, "ssd", $name, $family, $nomre_php);


// 3๏ธโฃ ุงุฌุฑุง ฺฉูุฆุฑ
$result = mysqli_stmt_execute($stmt);


// 4๏ธโฃ ุจุฑุฑุณ ูุชุฌู
if ($result) {
    echo "ุซุจุช ุจุง ููููุช ุงูุฌุงู ุดุฏ.";
} else {
    echo "ุฎุทุง ุฏุฑ ุซุจุช ุงุทูุงุนุงุช";
}


// 5๏ธโฃ ุจุณุชู
mysqli_stmt_close($stmt);
mysqli_close($connection);

?>
```

---

# ๐ ุชูุถุญ ฺฉุงูู ุชูุงุจุน Prepared Statement

---

## 1๏ธโฃ mysqli_prepare()

```php
$stmt = mysqli_prepare($connection, $sql);
```

ฺฉูุฆุฑ ุฑุง ุขูุงุฏู ูโฺฉูุฏ ูู ุงุฌุฑุง ููโฺฉูุฏ.
ุฏุฑ ุงู ูุฑุญูู:

1๏ธโฃ ฺฉูุฆุฑ ุจู ุฏุชุงุจุณ ูุฑุณุชุงุฏู ูโุดูุฏ
2๏ธโฃ ุฏุชุงุจุณ ุขู ุฑุง ุชุฌุฒู (Parse) ูโฺฉูุฏ
3๏ธโฃ ุณุงุฎุชุงุฑ ุฏุณุชูุฑ ุฑุง ูโูููุฏ
4๏ธโฃ ุฌุง ุนูุงูุชโูุง ? ุฑุง ูุดุฎุต ูโฺฉูุฏ
5๏ธโฃ ุงูุง ูููุฒ ูฺ ุฏุงุฏูโุง ูุงุฑุฏ ูุดุฏู ุงุณุช.

---

๐ ูฺฉุชู ููู ุงููุช

ุฏุฑ ุงู ูุฑุญูู ุฏุชุงุจุณ ุชุตูู ูโฺฏุฑุฏ:

ุงู ููุท ฺฉ ุฏุณุชูุฑ INSERT ุงุณุช
ู ููุท 3 ููุฏุงุฑ ุจุงุฏ ุจุนุฏุงู ูุงุฑุฏ ุดููุฏ

ุนู ุณุงุฎุชุงุฑ ุฏุณุชูุฑ ฺฉุงููุงู ููู ูโุดูุฏ ๐

ุฏฺฏุฑ ุงูฺฉุงู ุชุบุฑ ุณุงุฎุชุงุฑ SQL ูุฌูุฏ ูุฏุงุฑุฏ.

---

## 2๏ธโฃ mysqli_stmt_bind_param()

```php
mysqli_stmt_bind_param($stmt, "ssd", $name, $family, $nomre_php);
```
ุฏุฑ ุงู ูุฑุญูู:

ุฏุงุฏูโูุง ุจู ุตูุฑุช ุฌุฏุงฺฏุงูู

ุจุง ููุน ูุดุฎุต

ุจู ุฌุง ุนูุงูุชโูุง ?

ุชุฒุฑู ูโุดููุฏ


### ุงู ูุณูุช ุจู ุฏุชุงุจุณ ูโฺฏูุฏ:

ูพุงุฑุงูุชุฑ ุงูู โ ุฑุดุชู (string)

ูพุงุฑุงูุชุฑ ุฏูู โ ุฑุดุชู

ูพุงุฑุงูุชุฑ ุณูู โ ุนุฏุฏ ุงุนุดุงุฑ (double)

| ุญุฑู | ููุน ุฏุงุฏู            |
| --- | ------------------- |
| s   | string (ุฑุดุชู)       |
| i   | integer (ุนุฏุฏ ุตุญุญ)  |
| d   | double (ุนุฏุฏ ุงุนุดุงุฑ) |
| b   | blob                |

ุฏุฑ ูุซุงู ูุง:

* name โ string โ s
* family โ string โ s
* nomre_php โ double โ d

---

## 3๏ธโฃ mysqli_stmt_execute()

ฺฉูุฆุฑ ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.

---

## 4๏ธโฃ mysqli_stmt_close()

Statement ุฑุง ูโุจูุฏุฏ.

---

# ๐ ููุงุณู ุฏู ุฑูุด

| ุฑูุด                       | ุงููุช        | ูพุดููุงุฏ ุขููุฒุด      |
| ------------------------- | ------------ | ------------------- |
| mysqli_real_escape_string | ูุชูุณุท        | ุจุฑุง ุขุดูุง         |
| Prepared Statement        | ุจุณุงุฑ ุจุงูุง โญ | ุฑูุด ุงุณุชุงูุฏุงุฑุฏ ูุงูุน |
